<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - ZeeCryptoBot</title>
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="{{ url_for('static', filename='apple-icon-180x180.png') }}"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="{{ url_for('static', filename='favicon-32x32.png') }}"
    />
    <meta name="theme-color" content="#ffffff" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/dashboard.css') }}"
      type="text/css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="hamburger">
      <img
        src="{{ url_for('static', filename='icons/hamburger.png') }}"
        alt="Menu"
      />
    </div>

    <div class="sidebar">
      <div class="logo-container">
        <a href="/dashboard">
          <img
            src="{{ url_for('static', filename='images/zeecryptobotlogo.jpg') }}"
            alt=""
          />
        </a>
      </div>

      <h1>Welcome, {{ user.alias }}!</h1>
      <nav class="nav-top">
        <ul>
          <li id="symbol-select">
            <a href="#">
              <img
                src="{{ url_for('static', filename='icons/symbol.png') }}"
                alt="Symbol"
              />
              Symbol
            </a>
          </li>
          <li id="trade-amount">
            <a href="#">
              <img
                src="{{ url_for('static', filename='icons/trade.png') }}"
                alt="Trade Amount"
              />
              Amount to trade
            </a>
          </li>
          <li id="leverage">
            <a href="#">
              <img
                src="{{ url_for('static', filename='icons/leverage.png') }}"
                alt="Leverage"
              />
              Leverage
            </a>
          </li>
          <li id="pay-commission">
            <a href="#">
              <img
                src="{{ url_for('static', filename='icons/commission.png') }}"
                alt="Mining"
              />
              Pay Commission
            </a>
          </li>
          <li id="refer-friend">
            <a href="#">
              <img
                src="{{ url_for('static', filename='icons/refer.png') }}"
                alt="Launchpad"
              />
              Refer a friend
            </a>
          </li>
        </ul>
      </nav>
      <nav class="nav-bottom">
        <ul>
          <li>
            <a href="{{ url_for('profile', alias=user.alias) }}">
              <img
                src="{{ url_for('static', filename='icons/profile.png') }}"
                alt="Profile"
              />
              {{ user.alias }}
            </a>
          </li>
          <li>
            <a href="/logout">
              <img
                src="{{ url_for('static', filename='icons/logout.png') }}"
                alt="Logout"
              />
              Logout
            </a>
          </li>
        </ul>
      </nav>
    </div>

    <div class="main-content">
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %}
      <div class="alert-container">
        {% for category, message in messages %}
        <div
          class="alert alert-{{ category }} alert-dismissible fade show"
          role="alert"
        >
          {{ message }}
          <button
            type="button"
            class="close"
            data-dismiss="alert"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        {% endfor %}
      </div>
      {% endif %} {% endwith %}

      <div class="top-section">
        <button class="top-button">
          <p>Connect Wallet</p>
          <img
            src="{{ url_for('static', filename='icons/connect-wallet.png') }}"
            alt="Connect Wallet"
          />
        </button>
        <div class="top-text">
          <p>Create Token</p>
          <h2>Connect your wallet with one click!</h2>
          <h3>
            <span class="numberConnected">0</span> wallets connected today
          </h3>
          <p style="color: red; font-size: 0.7em">
            *Only 2000 wallets can be connected in a day
          </p>
        </div>
        <button class="top-button">
          <a href="/index/#tutorialVideo" target="_blank">
            <img
              src="{{ url_for('static', filename='icons/video.png') }}"
              alt="Tutorial Video"
            />
            <p>Tutorial Video</p>
          </a>
        </button>
      </div>

      {% block bottom %}
      <div class="bottom-section">
        {% if not api_credentials_set %}
        <!-- Show API credentials form if not set -->
        <form
          class="token-form"
          id="walletForm"
          method="POST"
          action="{{ url_for('connect_wallet') }}"
        >
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
          <h2>Enter API Parameter</h2>
          <label for="api-key">API KEY</label>
          <input
            type="text"
            id="api-key"
            name="api_key"
            placeholder="1-16 characters"
            required
          />
          <label for="api-secret">API SECRET</label>
          <input
            type="text"
            id="api-secret"
            name="api_secret"
            placeholder="0.99-44.532.5343"
            required
          />
          <div class="service-fee">
            <p>Service fee <span>$5</span></p>
          </div>
          <button type="submit" class="connectButton">Connect to Wallet</button>
        </form>
        {% else %}
        <div class="share-icons">
          <p>
            Your API credentials are already set. You can change them if needed.
          </p>

          <!-- Add a container for the button to ensure it's displayed as a block element -->
          <div class="button-container">
            <button class="changeButton" id="changeCredentialsButton">
              Change API Credentials
            </button>
          </div>

          <div class="button-container">
            <form
              action="{{ url_for('wallet_control') }}"
              method="GET"
              class="token-form"
            >
              <button type="submit" class="proceedButton">
                Proceed to Wallet Control
              </button>
            </form>
          </div>
        </div>

        {% endif %}

        <!-- This will display the result message -->
        <div id="result-message" style="display: none"></div>
      </div>
      {% endblock bottom %}
    </div>

    <script>
      const referFriendItem = document.getElementById("refer-friend");

      referFriendItem.addEventListener("click", function () {
        bottomSection.innerHTML = `
          <div class="share-icons">
            <div id="flash-messages"></div>
            <h2>Refer a Friend</h2>
            <p>Your referral code: <strong>{{ user.referral_code }}</strong></p>
            <p>Friends who signed up using your code: <strong>{{ user.referral_count }}</strong></p>
            <div class="share-icons">
              <h3>Share your code:</h3>
              <input type="text" id="referralLink" value="{{ url_for('auth', _external=True) }}?ref={{ user.referral_code }}" readonly>
              <button onclick="copyReferralLink()">Copy Link</button>
              <a href="https://twitter.com/share?text=Join ZeeCryptoBot and use my referral code {{ user.referral_code }}" target="_blank">
                <img src="{{ url_for('static', filename='icons/twitter.jpg') }}" alt="Twitter" />
              </a>
              <a href="https://facebook.com/sharer/sharer.php?u={{ url_for('auth', _external=True) }}?ref={{ user.referral_code }}" target="_blank">
                <img src="{{ url_for('static', filename='icons/facebook.png') }}" alt="Facebook" />
              </a>
              <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ url_for('auth', _external=True) }}?ref={{ user.referral_code }}" target="_blank">
                <img src="{{ url_for('static', filename='icons/linkedin.png') }}" alt="LinkedIn" />
              </a>
            </div>
          </div>
        `;
      });

      function copyReferralLink() {
        var copyText = document.getElementById("referralLink");
        copyText.select();
        copyText.setSelectionRange(0, 99999);
        document.execCommand("copy");
        alert("Copied the referral link: " + copyText.value);
      }
    </script>

    <!-- Include necessary libraries -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
  </body>
</html>
